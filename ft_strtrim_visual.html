<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interativo: ft_strtrim</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .container {
            max-width: 900px;
            width: 100%;
            background: #fff;
            padding: 20px 40px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
        }
        pre {
            background-color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            position: relative;
        }
        code {
            font-family: "Courier New", Courier, monospace;
            white-space: pre;
        }
        .code-line {
            display: block;
            padding: 2px 0;
        }
        .highlighted-line {
            background-color: #ffeb3b;
            border-radius: 3px;
        }
        .explanation {
            margin-top: 20px;
            padding: 15px;
            border-left: 3px solid #3498db;
            background-color: #f9f9f9;
            border-radius: 0 5px 5px 0;
            min-height: 100px;
        }
        .controls {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        .controls button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            color: #fff;
            transition: background-color 0.3s ease;
        }
        #prev-btn {
            background-color: #95a5a6;
        }
        #prev-btn:hover {
            background-color: #7f8c8d;
        }
        #next-btn {
            background-color: #3498db;
        }
        #next-btn:hover {
            background-color: #2980b9;
        }
        .example-data {
            margin-top: 20px;
            padding: 15px;
            border: 1px dashed #9b59b6;
            background-color: #fcf6ff;
            border-radius: 5px;
        }
        .example-data p {
            margin: 5px 0;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Interativo: <code>ft_strtrim</code></h1>
    <p>Use os botões para avançar ou voltar e entender a função passo a passo.</p>

    <div class="example-data">
        <h2>Exemplo</h2>
        <p><strong><code>s1</code>:</strong> <code id="s1-display">"---Olá, Mundo---"</code></p>
        <p><strong><code>set</code>:</strong> <code id="set-display">"-"</code></p>
        <p><strong>Resultado esperado:</strong> <code>"Olá, Mundo"</code></p>
        <p><strong>Variáveis:</strong> <code>i</code> = <span id="i-value">0</span>, <code>j</code> = <span id="j-value">0</span></p>
    </div>

    <pre id="code-block">
<code id="code-content">
<span class="code-line">char *ft_strtrim(char const *s1, char const *set)</span>
<span class="code-line">{</span>
<span class="code-line">    size_t  i;</span>
<span class="code-line">    size_t  j;</span>
<span class="code-line">    char    *new_str;</span>
<span class="code-line"></span>
<span class="code-line">    if (!s1 || !set)</span>
<span class="code-line">        return (NULL);</span>
<span class="code-line"></span>
<span class="code-line">    i = 0;</span>
<span class="code-line">    while (s1[i] && ft_strchr(set, s1[i]))</span>
<span class="code-line">        i++;</span>
<span class="code-line"></span>
<span class="code-line">    j = ft_strlen(s1);</span>
<span class="code-line">    while (j > i && ft_strchr(set, s1[j - 1]))</span>
<span class="code-line">        j--;</span>
<span class="code-line"></span>
<span class="code-line">    new_str = (char *)malloc(sizeof(char) * (j - i + 1));</span>
<span class="code-line">    if (!new_str)</span>
<span class="code-line">        return (NULL);</span>
<span class="code-line"></span>
<span class="code-line">    ft_strlcpy(new_str, s1 + i, j - i + 1);</span>
<span class="code-line">    return (new_str);</span>
<span class="code-line">}</span>
</code>
    </pre>

    <div class="controls">
        <button id="prev-btn">Anterior</button>
        <button id="next-btn">Próximo</button>
    </div>

    <div id="explanation-box" class="explanation">
        Clique em "Próximo" para começar a análise da função.
    </div>
</div>

<script>
const codeLines = document.querySelectorAll('.code-line');
const explanationBox = document.getElementById('explanation-box');
const prevBtn = document.getElementById('prev-btn');
const nextBtn = document.getElementById('next-btn');
const iValue = document.getElementById('i-value');
const jValue = document.getElementById('j-value');

let currentStep = 0;

const explanations = [
    { text: 'Início da função. Declaração das variáveis `i`, `j` e `new_str`.', line: 2, i: 0, j: 0 },
    { text: '<strong>Passo 1: Verificação de Nulos.</strong> A função verifica se `s1` ou `set` são nulos. Em nosso exemplo, ambos são válidos.', line: 6, i: 0, j: 0 },
    { text: '<strong>Passo 2: Encontrar o Início.</strong> A variável `i` é inicializada em 0, apontando para o primeiro caractere de `s1`.', line: 8, i: 0, j: 0 },
    { text: '<strong>Passo 3: Loop de Início.</strong> A condição do `while` verifica se o caractere atual (`s1[i]`, que é `-`) está no `set`. Como está, `i` é incrementado.', line: 9, i: 1, j: 0 },
    { text: 'O loop continua. O novo `s1[i]` (`-`) também está no `set`. `i` é incrementado.', line: 9, i: 2, j: 0 },
    { text: 'Mais uma vez, `s1[i]` (`-`) está no `set`. `i` é incrementado.', line: 9, i: 3, j: 0 },
    { text: 'Agora, `s1[i]` é `O`, que não está no `set`. A condição se torna falsa e o loop para. `i` é 3.', line: 9, i: 3, j: 0 },
    { text: '<strong>Passo 4: Encontrar o Fim.</strong> A variável `j` é inicializada com o tamanho total de `s1`, que é 16.', line: 11, i: 3, j: 16 },
    { text: '<strong>Passo 5: Loop de Fim.</strong> A condição do `while` verifica se `j` é maior que `i` e se `s1[j-1]` (`-`) está no `set`. Como ambas são verdadeiras, `j` é decrementado.', line: 12, i: 3, j: 15 },
    { text: 'O loop continua. `s1[j-1]` (`-`) ainda está no `set`. `j` é decrementado.', line: 12, i: 3, j: 14 },
    { text: 'Mais uma vez, `s1[j-1]` (`-`) está no `set`. `j` é decrementado.', line: 12, i: 3, j: 13 },
    { text: 'Agora, `s1[j-1]` (`o`) não está no `set`. A condição se torna falsa e o loop para. `j` é 13.', line: 12, i: 3, j: 13 },
    { text: '<strong>Passo 6: Alocação de Memória.</strong> O tamanho da nova string é calculado como `j - i + 1` = `13 - 3 + 1` = `11`. A memória é alocada para 11 caracteres.', line: 14, i: 3, j: 13 },
    { text: 'A função verifica se o `malloc` retornou um ponteiro nulo. Em nosso exemplo, a alocação foi bem-sucedida.', line: 15, i: 3, j: 13 },
    { text: '<strong>Passo 7: Cópia e Retorno.</strong> `ft_strlcpy` copia `j - i + 1` (11) caracteres de `s1` para `new_str`, começando do índice `i` (3).', line: 17, i: 3, j: 13 },
    { text: 'A função retorna o ponteiro para a nova string, que agora é "Olá, Mundo".', line: 18, i: 3, j: 13 }
];

function updateUI() {
    codeLines.forEach((line, index) => {
        line.classList.remove('highlighted-line');
        if (index + 1 === explanations[currentStep].line) {
            line.classList.add('highlighted-line');
        }
    });
    explanationBox.innerHTML = explanations[currentStep].text;
    iValue.textContent = explanations[currentStep].i;
    jValue.textContent = explanations[currentStep].j;
    
    prevBtn.disabled = currentStep === 0;
    nextBtn.disabled = currentStep === explanations.length - 1;
}

prevBtn.addEventListener('click', () => {
    if (currentStep > 0) {
        currentStep--;
        updateUI();
    }
});

nextBtn.addEventListener('click', () => {
    if (currentStep < explanations.length - 1) {
        currentStep++;
        updateUI();
    }
});

updateUI(); // Initialize the UI
</script>

</body>
</html>